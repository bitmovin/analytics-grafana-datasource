{"version":3,"sources":["../src/datasource.js"],"names":["_","convertFilterValueToProperType","ATTRIBUTE","ATTRIBUTE_LIST","AD_ATTRIBUTE_LIST","METRICS_ATTRIBUTE_LIST","ORDERBY_ATTRIBUTES","getAsOptionsList","AGGREGATION","calculateAutoInterval","getMomentTimeUnitForQueryInterval","QUERY_INTERVAL","transform","ResultFormat","OPERATOR","LicenseService","RequestHandler","getApiRequestUrl","baseUrl","isAdAnalytics","isMetric","mapMathOperatorToAnalyticsFilterOperator","operator","EQ","NE","LT","LTE","GT","GTE","BitmovinAnalyticsDatasource","instanceSettings","$q","backendSrv","templateSrv","type","url","jsonData","name","q","withCredentials","headers","apiKey","tenantOrgId","length","basicAuth","requestHandler","licenseService","options","query","buildQueryParameters","targets","filter","t","hide","when","data","getAdhocFilters","adhocFilters","targetResponsePromises","map","target","resultFormat","TIME_SERIES","interval","HOUR","filters","e","key","value","replace","scopedVars","orderBy","order","licenseKey","license","start","range","from","toISOString","end","to","includes","dimension","urlAppendix","metric","COUNT","LICENSE_KEY","percentileValue","AUTO","intervalMs","valueOf","intervalSnapTo","intervalTimeUnit","startOf","groupBy","forEach","INTERVAL","Number","limit","undefined","apiRequestUrl","requestOptions","method","resultTarget","alias","refId","doRequest","Promise","all","then","targetResponses","result","response","series","baseURL","status","message","title","resolve"],"mappings":"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","sourcesContent":["import _ from 'lodash';\nimport { convertFilterValueToProperType, ATTRIBUTE, ATTRIBUTE_LIST, AD_ATTRIBUTE_LIST, METRICS_ATTRIBUTE_LIST, ORDERBY_ATTRIBUTES, getAsOptionsList } from './types/queryAttributes';\nimport { AGGREGATION } from './types/aggregations';\nimport { calculateAutoInterval, getMomentTimeUnitForQueryInterval, QUERY_INTERVAL } from './types/intervals';\nimport { transform } from './result_transformer';\nimport { ResultFormat } from './types/resultFormat';\nimport { OPERATOR } from './types/operators';\nimport LicenseService from './licenseService';\nimport RequestHandler from './requestHandler';\n\nconst getApiRequestUrl = (baseUrl, isAdAnalytics, isMetric) => {\n  if (isAdAnalytics === true) {\n    return baseUrl + '/analytics/ads/queries';\n  }\n  if (isMetric == true) {\n    return baseUrl + '/analytics/metrics';\n  }\n  return baseUrl + '/analytics/queries';\n};\n\nconst mapMathOperatorToAnalyticsFilterOperator = (operator) => {\n  switch (operator) {\n    case '=':\n      return OPERATOR.EQ;\n    case '!=':\n      return OPERATOR.NE;\n    case '<':\n      return OPERATOR.LT;\n    case '<=':\n      return OPERATOR.LTE;\n    case '>':\n      return OPERATOR.GT;\n    case '>=':\n      return OPERATOR.GTE;\n    default:\n      return operator;\n  }\n};\n\nexport class BitmovinAnalyticsDatasource {\n\n  constructor(instanceSettings, $q, backendSrv, templateSrv) {\n    this.type = instanceSettings.type;\n    this.url = instanceSettings.url;\n    this.isAdAnalytics = instanceSettings.jsonData.isAdAnalytics;\n    this.name = instanceSettings.name;\n    this.q = $q;\n    this.backendSrv = backendSrv;\n    this.templateSrv = templateSrv;\n    this.withCredentials = instanceSettings.withCredentials;\n\n    const headers = {\n      'Content-Type': 'application/json',\n      'X-Api-Key': instanceSettings.jsonData.apiKey,\n    };\n\n    const tenantOrgId = instanceSettings.jsonData.tenantOrgId;\n    if (typeof tenantOrgId === 'string' && tenantOrgId.length > 0) {\n      headers['X-Tenant-Org-Id'] = tenantOrgId;\n    }\n\n    if (typeof instanceSettings.basicAuth === 'string' && instanceSettings.basicAuth.length > 0) {\n      headers['Authorization'] = instanceSettings.basicAuth;\n    }\n\n    this.requestHandler = new RequestHandler(backendSrv, headers, instanceSettings.withCredentials)\n    this.licenseService = new LicenseService(this.requestHandler, instanceSettings.url);\n  }\n\n  query(options) {\n    const query = this.buildQueryParameters(options);\n    query.targets = query.targets.filter(t => !t.hide);\n\n    if (query.targets.length <= 0) {\n      return this.q.when({ data: [] });\n    }\n\n    if (this.templateSrv.getAdhocFilters) {\n      query.adhocFilters = this.templateSrv.getAdhocFilters(this.name);\n    } else {\n      query.adhocFilters = [];\n    }\n\n    const targetResponsePromises = _.map(query.targets, target => {\n      target.resultFormat = target.resultFormat || ResultFormat.TIME_SERIES;\n      target.interval = target.interval || QUERY_INTERVAL.HOUR;\n\n      const filters = _.map([...target.filter, ...query.adhocFilters], e => {\n        let filter = {\n          name: (e.name) ? e.name : e.key,\n          operator: mapMathOperatorToAnalyticsFilterOperator(e.operator),\n          value: this.templateSrv.replace(e.value, options.scopedVars)\n        }\n        return {\n          name: filter.name,\n          operator: filter.operator,\n          value: convertFilterValueToProperType(filter)\n        }\n      });\n      const orderBy = _.map(target.orderBy, e => ({ name: e.name, order: e.order }));\n      const data = {\n        licenseKey: target.license,\n        start: options.range.from.toISOString(),\n        end: options.range.to.toISOString(),\n        filters,\n        orderBy\n      };\n\n      let isMetric = METRICS_ATTRIBUTE_LIST.includes(target.dimension);\n      let urlAppendix = '';\n\n      if (isMetric) {\n        urlAppendix = target.dimension;\n        data['metric'] = target.dimension\n      } else {\n        target.metric = target.metric || AGGREGATION.COUNT;\n        target.dimension = target.dimension || ATTRIBUTE.LICENSE_KEY;\n        urlAppendix = target.metric\n        data['dimension'] = target.dimension;\n\n        if (target.metric === 'percentile') {\n          data['percentile'] = target.percentileValue;\n        }\n      }\n\n      if (target.resultFormat === ResultFormat.TIME_SERIES) {\n        data['interval'] = target.interval;\n        if (target.interval === QUERY_INTERVAL.AUTO) {\n          const intervalMs = options.range.to.valueOf() - options.range.from.valueOf();\n          data['interval'] = calculateAutoInterval(intervalMs);\n        }\n\n        if (target.intervalSnapTo === true) {\n          const intervalTimeUnit = getMomentTimeUnitForQueryInterval(data['interval']);\n          if (intervalTimeUnit != null) {\n            data['start'] = options.range.from.startOf(intervalTimeUnit).toISOString();\n            data['end'] = options.range.to.startOf(intervalTimeUnit).toISOString();\n          }\n        }\n      }\n      data['groupBy'] = target.groupBy;\n      data['orderBy'].forEach(e => {\n        if (e.name == ORDERBY_ATTRIBUTES.INTERVAL) {\n          e.name = data['interval'];\n        }\n      });\n      data['limit'] = Number(target.limit) || undefined;\n      var apiRequestUrl = getApiRequestUrl(this.url, this.isAdAnalytics, isMetric);\n\n      const requestOptions = {\n        url: apiRequestUrl + '/' + urlAppendix,\n        data: data,\n        method: 'POST',\n        resultTarget: target.alias || target.refId,\n        resultFormat: target.resultFormat\n      };\n      return this.requestHandler.doRequest(requestOptions);\n    });\n\n    return Promise.all(targetResponsePromises).then(targetResponses => {\n      let result = [];\n      _.map(targetResponses, response => {\n        const series = transform(response, options);\n        result = [...result, ...series];\n      });\n      return {\n        data: result\n      };\n    });\n  }\n\n  testDatasource() {\n    const requestOptions = {\n      url: this.baseURL + '/analytics/licenses',\n      method: 'GET',\n    };\n    return this.requestHandler.doRequest(requestOptions).then(response => {\n      if (response.status === 200) {\n        return { status: \"success\", message: \"Data source is working\", title: \"Success\" };\n      }\n      return { status: \"error\", message: \"Data source is not working\", title: \"Error\" };\n    });\n  }\n\n  annotationQuery(options) {\n\n  }\n\n  metricFindQuery(query) {\n\n  }\n\n  getTagKeys(options) {\n    if (this.isAdAnalytics) {\n      return Promise.resolve(getAsOptionsList(AD_ATTRIBUTE_LIST));\n    }\n    return Promise.resolve(getAsOptionsList(ATTRIBUTE_LIST));\n  }\n\n  buildQueryParameters(options) {\n    return options;\n  }\n}\n"],"file":"datasource.js"}